!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sqlFormatter=t():e.sqlFormatter=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"format",(function(){return z})),n.d(t,"supportedDialects",(function(){return K}));var r=["database","table","view","as","attach","drop","detach","rename","alter","show","databases","tables","processlist","describe","exists","use","set","optimize","insert","into","select","from","sample","join","inner","left","right","on","where","prewhere",["group","keyword","\n  **GROUP BY column_name**\n  ","GROUP BY column_name","column_name"],["between","keyword","\n  **BETWEEN cond1 AND cond2**\n  \n  Shortcut for filter between two values. \n","BETWEEN cond1 AND cond2","cond1"],"by","with","totals","having",["order","keyword","\n  **ORDER BY column_name**\n  ","ORDER BY column_name","column_name"],"asc","desc","distinct","limit","union","all","format","in","engine","kill","query","null","and","is","or","not","xor"],a=["plus","minus","multiply","divide","intDiv","intDivOrZero","modulo","negate","abs","bitAnd",["bitCount","fn()","\n  **bitCount(column_name)**\n\n  Calculate the number of set bits in the supplied integer number\n  ","bitCount(column_name)","column_name"],"bitOr","bitXor","bitNot","bitShiftLeft","bitShiftRight","equals","notEquals","less","greater","lessOrEquals","greaterOrEquals","toUInt8","toUInt16","toUInt32","toUInt64","toInt8","toInt16","toInt32","toInt64","toFloat32","toFloat64","toUInt8OrZero","toUInt16OrZero","toUInt32OrZero","toUInt64OrZero","toInt8OrZero","toInt16OrZero","toInt32OrZero","toInt64OrZero","toFloat32OrZero","toFloat64OrZero","toDecimal32","toDecimal64","toDecimal128",["toDate","fn()","\n  **toDate(column_name)**\n\n  Converts value to date without time. [Learn more](https://clickhouse.yandex/docs/en/query_language/functions/type_conversion_functions/#todate-todatetime)\n  ","toDate(column_name)","column_name"],"toDateTime","toString","toFixedString","toStringCutToZero","toUnixTimestamp64Milli","fromUnixTimestamp64Milli","toUnixTimestamp64Micro","fromUnixTimestamp64Micro","toUnixTimestamp64Nano","fromUnixTimestamp64Nano","reinterpretAsUInt8","reinterpretAsUInt16","reinterpretAsUInt32","reinterpretAsUInt64","reinterpretAsInt8","reinterpretAsInt16","reinterpretAsInt32","reinterpretAsInt64","reinterpretAsFloat32","reinterpretAsFloat64","reinterpretAsDate","reinterpretAsDateTime","reinterpretAsString",["startsWith","fn()","\n  **startsWith(str, prefix)**\n  \n  Returns 1 whether string starts with the specified prefix, otherwise it returns 0.\n  ","startsWith(str, prefix)","str"],["endsWith","fn()","\n  **endsWith(str, suffix)**\n  \n  Returns 1 if the string ends with the specified suffix, otherwise it returns 0.\n  ","endsWith(str, suffix)","str"],"toYear","toMonth","toDayOfMonth","toDayOfWeek","toHour","toMinute","toSecond","toMonday",["toStartOfWeek","fn()","\n  **toStartOfWeek(t, [mode])**\n\n  Rounds down a date or date with time to the nearest Sunday or Monday by mode. Returns the date. The mode argument works exactly like the mode argument to [toWeek()](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#toweek-date-mode). For the single-argument syntax, a mode value of 0 is used, where week 1 is the first one with a Sunday in the given year. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofweek-t-mode)\n  ","toStartOfWeek(column_or_date_or_datetime)","column_or_date_or_datetime"],["toStartOfMonth","fn()","\n  **toStartOfMonth(t)**\n\n  Rounds down a date or date with time to the first day of the month. Returns the date. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofmonth)\n  ","toStartOfMonth(column_or_date_or_datetime)","column_or_date_or_datetime"],["toStartOfQuarter","fn()","\n  **toStartOfQuarter(t)**\n\n  Rounds down a date or date with time to the first day of the quarter. The first day of the quarter is either 1 January, 1 April, 1 July, or 1 October. Returns the date. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofquarter)\n  ","toStartOfQuarter(column_or_date_or_datetime)","column_or_date_or_datetime"],["toStartOfYear","fn()","\n  **toStartOfYear(t)**\n\n  Rounds down a date or date with time to the first day of the year. Returns the date. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofyear)\n  ","toStartOfYear(column_or_date_or_datetime)","column_or_date_or_datetime"],["toStartOfDay","fn()","\n  **toStartOfDay(t)**\n\n  Rounds down a date with time to the start of the day. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofday)\n  ","toStartOfDay(column_or_datetime)","column_or_datetime"],["toStartOfHour","fn()","\n  **toStartOfHour(t)**\n\n  Rounds down date with time to the start of the hour. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofhour)\n  ","toStartOfHour(column_or_datetime)","column_or_datetime"],["toStartOfMinute","fn()","\n  **toStartOfMinute(t)**\n\n  Rounds down a date with time to the start of the minute. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofminute)\n  ","toStartOfMinute(column_or_datetime)","column_or_datetime"],["toStartOfFiveMinute","fn()","\n  **toStartOfFiveMinute(t)**\n\n  Rounds down a date with time to the start of the five-minute interval. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartoffiveminute)\n  ","toStartOfFiveMinute(column_or_datetime)","column_or_datetime"],["toStartOfFifteenMinutes","fn()","\n  **toStartOfFifteenMinutes(t)**\n\n  Rounds down a date with time to the start of the fifteen-minute interval. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartoffifteenminutes)\n  ","toStartOfFifteenMinutes(column_or_datetime)","column_or_datetime"],["toStartOfInterval","fn()","\n  **toStartOfInterval(t, INTERVAL x unit [, time_zone])**\n\n  This is a generalization of other functions named toStartOf*. For example, toStartOfInterval(t, INTERVAL 1 year) returns the same as toStartOfYear(t), toStartOfInterval(t, INTERVAL 1 month) returns the same as toStartOfMonth(t), toStartOfInterval(t, INTERVAL 1 day) returns the same as toStartOfDay(t), toStartOfInterval(t, INTERVAL 15 minute) returns the same as toStartOfFifteenMinutes(t) etc. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#tostartofinterval-time-or-data-interval-x-unit-time-zone)\n  ","toStartOfInterval(column_or_date_or_datetime, INTERVAL x unit)","column_or_date_or_datetime"],"toTime","toRelativeYearNum","toRelativeMonthNum","toRelativeWeekNum","toRelativeDayNum","toRelativeHourNum","toRelativeMinuteNum","toRelativeSecondNum","toYYYYMM","toYYYYMMDD","toYYYYMMDDhhmmss",["addYears","fn()","\n  **addYears(column_name, number_of_years)**\n\n  Function adds specified number of years to a Date/DateTime and then return the Date/DateTime.\n  ","addYears(column_name, 1)","column_name"],["addMonths","fn()","\n  **addMonths(column_name, number_of_months)**\n\n  Function adds specified number of months to a Date/DateTime and then return the Date/DateTime.\n  ","addMonths(column_name, 1)","column_name"],["addWeeks","fn()","\n  **addWeeks(column_name, number_of_weeks)**\n\n  Function adds specified number of weeks to a Date/DateTime and then return the Date/DateTime.\n  ","addWeeks(column_name, 1)","column_name"],["addDays","fn()","\n  **addDays(column_name, number_of_days)**\n\n  Function adds specified number of days to a Date/DateTime and then return the Date/DateTime.\n  ","addDays(column_name, 1)","column_name"],["addHours","fn()","\n  **addHours(column_name, number_of_hours)**\n\n  Function adds specified number of hours to a Date/DateTime and then return the Date/DateTime.\n  ","addHours(column_name, 1)","column_name"],["addMinutes","fn()","\n  **addMinutes(column_name, number_of_minutes)**\n\n  Function adds specified number of minutes to a Date/DateTime and then return the Date/DateTime.\n  ","addMinutes(column_name, 1)","column_name"],["addSeconds","fn()","\n  **addSeconds(column_name, number_of_seconds)**\n\n  Function adds specified number of seconds to a Date/DateTime and then return the Date/DateTime.\n  ","addSeconds(column_name, 1)","column_name"],["addQuarters","fn()","\n  **addQuarters(column_name, number_of_quarters)**\n\n  Function adds specified number of quarters to a Date/DateTime and then return the Date/DateTime.\n  ","addQuarters(column_name, 1)","column_name"],["now","fn()","\n  **now()**\n  \n  Returns the current time at one of the moments of request execution. [Learn more](https://clickhouse.yandex/docs/en/query_language/functions/date_time_functions/#now)\n  ","now()"],"now64",["today","fn()","\n  **today()**\n  \n  Accepts zero arguments and returns the current date at one of the moments of request execution. The same as 'toDate(now())'. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#today)\n  ","today()"],["yesterday","fn()","\n  **yesterday()**\n  \n  Accepts zero arguments and returns yesterday's date at one of the moments of request execution. The same as 'today() - 1'. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/date_time_functions/#yesterday)\n  ","yesterday()"],"timeSlot","timeSlots","formatDateTime","empty","notEmpty","length","lengthUTF8","lower","upper","lowerUTF8","upperUTF8","reverse","reverseUTF8","concat","substring","substringUTF8","appendTrailingCharIfAbsent","convertCharset","base64Encode","base64Decode","tryBase64Decode","position","positionUTF8","match","extract","extractAll","like","notLike","replaceOne","replaceAll","replaceRegexpOne","replaceRegexpAll","emptyArrayUInt8","emptyArrayUInt16","emptyArrayUInt32","emptyArrayUInt64","emptyArrayInt8","emptyArrayInt16","emptyArrayInt32","emptyArrayInt64","emptyArrayFloat32","emptyArrayFloat64","emptyArrayDate","emptyArrayDateTime","emptyArrayString","emptyArrayToSingle","range","array","arrayConcat","arrayElement","has","hasAll","hasAny","indexOf","countEqual","arrayEnumerate","arrayEnumerateUniq","arrayJoin","arrayPopBack","arrayPopFront","arrayPushBack","arrayPushFront","arrayResize","arraySlice","arrayUniq","operator","arrayMap","arrayFilter","arrayCount","arrayExists","arrayAll","arraySum","arrayCumSum","arraySort","arrayReverseSort","arrayFirst","arrayFirstIndex",["arrayZip","fn()","\n  **arrayZip(arr1, arr2, ..., arrN)**\n\n  Allows to combine multiple arrays of equal lengths into one array of tuples.\n  ","arrayZip(arr1)"],"splitByChar","splitByString","arrayStringConcat","alphaTokens","protocol","domain","domainWithoutWWW","topLevelDomain","firstSignificantSubdomain","cutToFirstSignificantSubdomain","path","pathFull","queryString","fragment","queryStringAndFragment","extractURLParameter","extractURLParameters","extractURLParameterNames","URLHierarchy","URLPathHierarchy","decodeURLComponent","cutWWW","cutQueryString","cutFragment","cutQueryStringAndFragment","cutURLParameter","IPv4NumToString","IPv4StringToNum","IPv4NumToStringClassC","IPv6NumToString","IPv6StringToNum","rand","rand64","randConstant","halfMD5","MD5","sipHash64","sipHash128","cityHash64","intHash32","intHash64","SHA224","SHA256","URLHash","hex","unhex","UUIDStringToNum","UUIDNumToString","bitmaskToList","bitmaskToArray","floor","ceil","round","roundToExp2","roundDuration","roundAge","if","multiIf","ifNotFinite","e","pi","exp","log","exp2","log2","exp10","log10","sqrt","cbrt","erf","erfc","lgamma","tgamma","sin","cos","tan","asin","acos","atan","pow","regionToCity","regionToArea","regionToDistrict","regionToCountry","regionToContinent","regionToPopulation","regionIn","regionHierarchy","regionToName","greatCircleDistance","greatCircleAngle","pointInEllipses","pointInPolygon","geoDistance","geohashEncode","geohashDecode","geohashesInBox","OSIn","SEIn","dictGetUInt8","dictGetUInt16","dictGetUInt32","dictGetUInt64","dictGetInt8","dictGetInt16","dictGetInt32","dictGetInt64","dictGetFloat32","dictGetFloat64","dictGetDate","dictGetDateTime","dictGetString","dictGetUUID","dictGetTOrDefault","dictIsIn","dictGetHierarchy","dictHas","visitParamHas","visitParamExtractUInt","visitParamExtractInt","visitParamExtractFloat","visitParamExtractBool","visitParamExtractRaw","visitParamExtractString","in","tuple","tupleElement","hostName","visibleWidth","toTypeName","blockSize","materialize","ignore","sleep","currentDatabase",["joinGet","fn()","\n  **joinGet(data_source_name, 'column_value', 'join_keys')**\n\n  Extract data from the table the same way as from a dictionary\n  ","joinGet(data_source_name, 'column_value', 'join_keys')","data_source_name"],"hasColumnInTable","formatReadableSize","isConstant","isFinite","isInfinite","isNaN","isNull","isNotNull","coalesce","ifNull","nullIf","assumeNotNull","toNullable","bar","transform","notIn","least","greatest","uptime","version","rowNumberInAllBlocks","runningDifference","MACNumToString","MACStringToNum","MACStringToOUI","getSizeOfEnumType","toColumnTypeName","dumpColumnStructure","defaultValueOfArgumentType","indexHint","replicate","globalIn","globalNotIn","lambda","count","any","anyHeavy","anyLast","groupBitAnd","groupBitOr","groupBitXor","min","max","argMin","argMax","sum","sumWithOverflow","sumMap","avg","avgWeighted",["uniq","fn()","\n  **uniq(x)**\n\n  Calculates the approximate number of different values of the argument. Works for numbers, strings, dates, and dates with times. [Learn more](https://clickhouse-docs.readthedocs.io/en/latest/agg_functions/#uniq-x)\n  ","uniq(x)","x"],["uniqHLL12","fn()","\n  **uniqHLL12(x)**\n\n  Uses the HyperLogLog algorithm to approximate the number of different values of the argument. It uses 212 5-bit cells. [Learn more](https://clickhouse-docs.readthedocs.io/en/latest/agg_functions/#uniqhll12-x)\n  ","uniqHLL12(x)","x"],["uniqExact","fn()","\n  **uniqExact(x)**\n\n  Exact number of different values of the argument. There is no reason to fear approximations, so it’s better to use the ‘uniq’ function. You should use the ‘uniqExact’ function if you definitely need an exact result. [Learn more](https://clickhouse-docs.readthedocs.io/en/latest/agg_functions/#uniqexact-x)\n  ","uniqExact(x)","x"],["uniqCombined","fn()","\n  **uniqCombined(x)**\n\n  Approximately computes the number of different values ​​of the argument. Works for numbers, strings, dates, date-with-time. [Learn more](https://clickhouse-docs.readthedocs.io/en/latest/agg_functions/#uniqcombined-x)\n  ","uniqCombined(x)","x"],"aggThrow","groupArray","groupArraySample","groupArrayInsertAt","groupUniqArray","median","medianTiming","medianDeterministic","medianTimingWeighted","varSamp","varPop","stddevSamp","stddevPop","covarSamp","covarPop","topK",["corr","fn()","\n  **corr(x,y)**\n\n  Calculates the Pearson correlation coefficient. [Learn more](https://clickhouse.yandex/docs/en/query_language/agg_functions/reference/#corr-x-y)\n  ","cor(x,y)","x"],["histogram","fn()","\n  **histogram(number_of_bins)(values)**\n\n  Calculates an adaptive histogram. It doesn't guarantee precise results. [Learn more](https://clickhouse.yandex/docs/en/query_language/agg_functions/parametric_functions/#histogram)\n  ","histogram(number_of_bins)(values)","number_of_bins"],"quantile","quantiles","quantileTiming","quantilesTiming","quantileTimingWeighted","quantilesTimingWeighted","quantileDeterministic","quantilesDeterministic","quantileExact","quantileExactWeighted","quantileTDigest","sequenceMatch","sequenceCount","windowFunnel","retention","uniqUpTo",["countIf","fn()","\n  **countIf(condition)**\n\n  Count the number of rows that satifies a condition. [Learn more](https://clickhouse-docs.readthedocs.io/en/latest/agg_functions/#if-combinator-conditional-aggregate-functions)\n  ","countIf(cond)","cond"],"anyIf","anyLastIf","minIf","maxIf","argMinIf","argMaxIf","sumIf","avgIf","uniqIf","uniqHLL12If","uniqExactIf","groupArrayIf","groupUniqArrayIf","medianIf","medianTimingIf","medianDeterministicIf","medianTimingWeightedIf","varSampIf","varPopIf","stddevSampIf","stddevPopIf","covarSampIf","covarPopIf","corrIf","quantileIf","quantilesIf","quantileTimingIf","quantilesTimingIf","quantileTimingWeightedIf","quantilesTimingWeightedIf","quantileDeterministicIf","quantilesDeterministicIf","sequenceMatchIf","uniqUpToIf","arraySplit","arrayReduce","arrayReduceInRanges","countArray","anyArray","anyLastArray","minArray","maxArray","argMinArray","argMaxArray","sumArray","avgArray","uniqArray","uniqHLL12Array","uniqExactArray","groupArrayArray","groupUniqArrayArray","medianArray","medianTimingArray","medianDeterministicArray","medianTimingWeightedArray","varSampArray","varPopArray","stddevSampArray","stddevPopArray","covarSampArray","covarPopArray","corrArray","quantileArray","quantilesArray","quantileTimingArray","quantilesTimingArray","quantileTimingWeightedArray","quantilesTimingWeightedArray","quantileDeterministicArray","quantilesDeterministicArray","sequenceMatchArray","uniqUpToArray","countState","anyState","anyLastState","minState","maxState","argMinState","argMaxState","sumState","avgState","uniqState","uniqHLL12State","uniqExactState","groupArrayState","groupUniqArrayState","medianState","medianTimingState","medianDeterministicState","medianTimingWeightedState","varSampState","varPopState","stddevSampState","stddevPopState","covarSampState","covarPopState","corrState","quantileState","quantilesState","quantileTimingState","quantilesTimingState","quantileTimingWeightedState","quantilesTimingWeightedState","quantileDeterministicState","quantilesDeterministicState","sequenceMatchState","uniqUpToState","countMerge","anyMerge","anyLastMerge","minMerge","maxMerge","argMinMerge","argMaxMerge","sumMerge","avgMerge","uniqMerge","uniqHLL12Merge","uniqExactMerge","groupArrayMerge","groupUniqArrayMerge","medianMerge","medianTimingMerge","medianDeterministicMerge","medianTimingWeightedMerge","varSampMerge","varPopMerge","stddevSampMerge","stddevPopMerge","covarSampMerge","covarPopMerge","corrMerge","quantileMerge","quantilesMerge","quantileTimingMerge","quantilesTimingMerge","quantileTimingWeightedMerge","quantilesTimingWeightedMerge","quantileDeterministicMerge","quantilesDeterministicMerge","sequenceMatchMerge","uniqUpToMerge","file","merge","numbers","remote","url","jdbc",["JSONExtractString","fn()","\n  **JSONExtractString(json[, indices_or_keys]…)**\n  \n  Parses a JSON and extract a string. This function is similar to visitParamExtractString functions. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/json_functions/#jsonextractstringjson-indices-or-keys)\n  ","JSONExtractString(json[, indices_or_keys]…)","json"],["JSONExtractBool","fn()","\n  **JSONExtractBool(json[, indices_or_keys]…)**\n  \n  Parses a JSON and extract a value. These functions are similar to visitParam functions. If the value does not exist or has a wrong type, 0 will be returned. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/json_functions/#jsonextractbooljson-indices-or-keys)\n  ","JSONExtractBool(json[, indices_or_keys]…)","json"],["JSONExtract","fn()","\n  **JSONExtract(json[, indices_or_keys]…)**\n  \n  Parses a JSON and extract a value of the given ClickHouse data type. [Learn more](https://clickhouse.tech/docs/en/query_language/functions/json_functions/#jsonextractjson-indices-or-keys-return-type)\n  ","JSONExtract(json[, indices_or_keys]…)","json"],["JSONExtractArrayRaw","fn()","\n  **JSONExtractArrayRaw(json)**\n\n  Returns an array on unparsed json array elements from JSON string\n  ","JSONExtractArrayRaw(json)","json"],"initializeAggregation","parseDateTimeBestEffortUS"],o={WORD:"word",STRING:"string",RESERVED:"reserved",RESERVED_TOP_LEVEL:"reserved-top-level",RESERVED_TOP_LEVEL_NO_INDENT:"reserved-top-level-no-indent",RESERVED_NEWLINE:"reserved-newline",OPERATOR:"operator",OPEN_PAREN:"open-paren",CLOSE_PAREN:"close-paren",LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",NUMBER:"number",PLACEHOLDER:"placeholder"},i=function(e){return e.replace(/[\t ]+$/,"")},s=function(e){return e.replace(/[\$\(-\+\.\?\[-\^\{-\}]/g,"\\$&")},u=function(e){return e.sort((function(e,t){return t.length-e.length||e.localeCompare(t)}))};function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indent=t||"  ",this.indentTypes=[]}var t,n,r;return t=e,(n=[{key:"getIndent",value:function(){return this.indent.repeat(this.indentTypes.length)}},{key:"increaseTopLevel",value:function(){this.indentTypes.push("top-level")}},{key:"increaseBlockLevel",value:function(){this.indentTypes.push("block-level")}},{key:"decreaseTopLevel",value:function(){var e;this.indentTypes.length>0&&"top-level"===(e=this.indentTypes)[e.length-1]&&this.indentTypes.pop()}},{key:"decreaseBlockLevel",value:function(){for(;this.indentTypes.length>0&&"top-level"===this.indentTypes.pop(););}},{key:"resetIndentation",value:function(){this.indentTypes=[]}}])&&c(t.prototype,n),r&&c(t,r),e}();function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=0}var t,n,r;return t=e,(n=[{key:"beginIfPossible",value:function(e,t){0===this.level&&this.isInlineBlock(e,t)?this.level=1:this.level>0?this.level++:this.level=0}},{key:"end",value:function(){this.level--}},{key:"isActive",value:function(){return this.level>0}},{key:"isInlineBlock",value:function(e,t){for(var n=0,r=0,a=t;a<e.length;a++){var i=e[a];if((n+=i.value.length)>50)return!1;if(i.type===o.OPEN_PAREN)r++;else if(i.type===o.CLOSE_PAREN&&0==--r)return!0;if(this.isForbiddenToken(i))return!1}return!1}},{key:"isForbiddenToken",value:function(e){var t=e.type,n=e.value;return t===o.RESERVED_TOP_LEVEL||t===o.RESERVED_NEWLINE||t===o.COMMENT||t===o.BLOCK_COMMENT||";"===n}}])&&m(t.prototype,n),r&&m(t,r),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=t,this.index=0}var t,n,r;return t=e,(n=[{key:"get",value:function(e){var t=e.key,n=e.value;return this.params?t?this.params[t]:this.params[this.index++]:n}}])&&f(t.prototype,n),r&&f(t,r),e}(),p=function(e,t){return function(n){return(null==n?void 0:n.type)===e&&t.test(null==n?void 0:n.value)}},y=p(o.RESERVED_NEWLINE,/^AND$/i),g=p(o.RESERVED,/^BETWEEN$/i),E=p(o.RESERVED_TOP_LEVEL,/^LIMIT$/i);p(o.RESERVED_TOP_LEVEL,/^[S\u017F]ET$/i),p(o.RESERVED,/^BY$/i),p(o.RESERVED_TOP_LEVEL,/^WINDOW$/i),p(o.CLOSE_PAREN,/^END$/i);function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t,this.indentation=new l(this.cfg.indent),this.inlineBlock=new d,this.params=new h(this.cfg.params),this.previousReservedToken={},this.tokens=[],this.index=0}var t,n,r;return t=e,(n=[{key:"tokenizer",value:function(){throw new Error("tokenizer() not implemented by subclass")}},{key:"tokenOverride",value:function(e){return e}},{key:"format",value:function(e){return this.tokens=this.tokenizer().tokenize(e),this.getFormattedQueryFromTokens().trim()}},{key:"getFormattedQueryFromTokens",value:function(){var e=this,t="";return this.tokens.forEach((function(n,r){e.index=r,(n=e.tokenOverride(n)).type===o.LINE_COMMENT?t=e.formatLineComment(n,t):n.type===o.BLOCK_COMMENT?t=e.formatBlockComment(n,t):n.type===o.RESERVED_TOP_LEVEL?(t=e.formatTopLevelReservedWord(n,t),e.previousReservedToken=n):n.type===o.RESERVED_TOP_LEVEL_NO_INDENT?(t=e.formatTopLevelReservedWordNoIndent(n,t),e.previousReservedToken=n):n.type===o.RESERVED_NEWLINE?(t=e.formatNewlineReservedWord(n,t),e.previousReservedToken=n):n.type===o.RESERVED?(t=e.formatWithSpaces(n,t),e.previousReservedToken=n):t=n.type===o.OPEN_PAREN?e.formatOpeningParentheses(n,t):n.type===o.CLOSE_PAREN?e.formatClosingParentheses(n,t):n.type===o.PLACEHOLDER?e.formatPlaceholder(n,t):","===n.value?e.formatComma(n,t):":"===n.value?e.formatWithSpaceAfter(n,t):"."===n.value?e.formatWithoutSpaces(n,t):";"===n.value?e.formatQuerySeparator(n,t):e.formatWithSpaces(n,t)})),t}},{key:"formatLineComment",value:function(e,t){return this.addNewline(t+this.show(e))}},{key:"formatBlockComment",value:function(e,t){return this.addNewline(this.addNewline(t)+this.indentComment(e.value))}},{key:"indentComment",value:function(e){return e.replace(/\n[\t ]*/g,"\n"+this.indentation.getIndent()+" ")}},{key:"formatTopLevelReservedWordNoIndent",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t)+this.equalizeWhitespace(this.show(e)),this.addNewline(t)}},{key:"formatTopLevelReservedWord",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t),this.indentation.increaseTopLevel(),t+=this.equalizeWhitespace(this.show(e)),this.addNewline(t)}},{key:"formatNewlineReservedWord",value:function(e,t){return y(e)&&g(this.tokenLookBehind(2))?this.formatWithSpaces(e,t):this.addNewline(t)+this.equalizeWhitespace(this.show(e))+" "}},{key:"equalizeWhitespace",value:function(e){return e.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g," ")}},{key:"formatOpeningParentheses",value:function(e,t){var n,r,a=(v(n={},o.OPEN_PAREN,!0),v(n,o.LINE_COMMENT,!0),v(n,o.OPERATOR,!0),n);return 0!==e.whitespaceBefore.length||a[null===(r=this.tokenLookBehind())||void 0===r?void 0:r.type]||(t=i(t)),t+=this.show(e),this.inlineBlock.beginIfPossible(this.tokens,this.index),this.inlineBlock.isActive()||(this.indentation.increaseBlockLevel(),t=this.addNewline(t)),t}},{key:"formatClosingParentheses",value:function(e,t){return this.inlineBlock.isActive()?(this.inlineBlock.end(),this.formatWithSpaceAfter(e,t)):(this.indentation.decreaseBlockLevel(),this.formatWithSpaces(e,this.addNewline(t)))}},{key:"formatPlaceholder",value:function(e,t){return t+this.params.get(e)+" "}},{key:"formatComma",value:function(e,t){return t=i(t)+this.show(e)+" ",this.inlineBlock.isActive()||E(this.previousReservedToken)?t:this.addNewline(t)}},{key:"formatWithSpaceAfter",value:function(e,t){return i(t)+this.show(e)+" "}},{key:"formatWithoutSpaces",value:function(e,t){return i(t)+this.show(e)}},{key:"formatWithSpaces",value:function(e,t){return t+this.show(e)+" "}},{key:"formatQuerySeparator",value:function(e,t){return this.indentation.resetIndentation(),i(t)+this.show(e)+"\n".repeat(this.cfg.linesBetweenQueries||1)}},{key:"show",value:function(e){var t=e.type,n=e.value;return!this.cfg.uppercase||t!==o.RESERVED&&t!==o.RESERVED_TOP_LEVEL&&t!==o.RESERVED_TOP_LEVEL_NO_INDENT&&t!==o.RESERVED_NEWLINE&&t!==o.OPEN_PAREN&&t!==o.CLOSE_PAREN?n:n.toUpperCase()}},{key:"addNewline",value:function(e){return(e=i(e)).endsWith("\n")||(e+="\n"),e+this.indentation.getIndent()}},{key:"tokenLookBehind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index-e]}},{key:"tokenLookAhead",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index+e]}}])&&_(t.prototype,n),r&&_(t,r),e}();function S(e){if(0===e.length)return new RegExp("^\b$","u");var t=u(e).join("|").replace(/ /g,"\\s+").replace("{%","\\{%").replace("%}","%\\}");return new RegExp("^(".concat(t,")"),"iu")}function O(e){var t={"``":"((`[^`]*($|`))+)","{}":"((\\{[^\\}]*($|\\}))+)","[]":"((\\[[^\\]]*($|\\]))(\\][^\\]]*($|\\]))*)",'""':'(("[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',"''":"(('[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","N''":"((N'[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","U&''":"((U&'[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)",'U&""':'((U&"[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',$$:"((?<tag>\\$\\w*\\$)[\\s\\S]*?(?:\\k<tag>|$))"};return e.map((function(e){return t[e]})).join("|")}function R(e){return new RegExp("^("+e.map(k).join("|")+")","iu")}function k(e){return 1===e.length?s(e):"\\b"+e+"\\b"}function N(e,t){if(n=e,!Array.isArray(n)||0===n.length)return!1;var n,r=e.map(s).join("|");return new RegExp("^((?:".concat(r,")(?:").concat(t,"))"),"u")}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(t){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.WHITESPACE_REGEX=/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)/,this.NUMBER_REGEX=/^((\x2D[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?[0-9]+(\.[0-9]+)?([Ee]\x2D?[0-9]+(\.[0-9]+)?)?|0x[0-9A-Fa-f]+|0b[01]+)\b/,this.OPERATOR_REGEX=(n=["<>","<=",">="].concat(L(t.operators||[])),new RegExp("^(".concat(u(n).map(s).join("|"),"|.)"),"u")),this.BLOCK_COMMENT_REGEX=/^(\/\*(?:(?![])[\s\S])*?(?:\*\/|$))/,this.LINE_COMMENT_REGEX=(r=t.lineCommentTypes,new RegExp("^((?:".concat(r.map((function(e){return s(e)})).join("|"),").*?)(?:\r\n|\r|\n|$)"),"u")),this.RESERVED_TOP_LEVEL_REGEX=S(t.reservedTopLevelWords),this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX=S(t.reservedTopLevelWordsNoIndent),this.RESERVED_NEWLINE_REGEX=S(t.reservedNewlineWords),this.RESERVED_PLAIN_REGEX=S(t.reservedWords),this.WORD_REGEX=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new RegExp("^([\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}".concat(e.join(""),"]+)"),"u")}(t.specialWordChars),this.STRING_REGEX=(a=t.stringTypes,new RegExp("^("+O(a)+")","u")),this.OPEN_PAREN_REGEX=R(t.openParens),this.CLOSE_PAREN_REGEX=R(t.closeParens),this.INDEXED_PLACEHOLDER_REGEX=N(t.indexedPlaceholderTypes,"[0-9]*"),this.IDENT_NAMED_PLACEHOLDER_REGEX=N(t.namedPlaceholderTypes,"[a-zA-Z0-9._$]+"),this.STRING_NAMED_PLACEHOLDER_REGEX=N(t.namedPlaceholderTypes,O(t.stringTypes))}var t,n,r;return t=e,(n=[{key:"tokenize",value:function(e){for(var t,n=[];e.length;){var r=this.getWhitespace(e);(e=e.substring(r.length)).length&&(t=this.getNextToken(e,t),e=e.substring(t.value.length),n.push(I(I({},t),{},{whitespaceBefore:r})))}return n}},{key:"getWhitespace",value:function(e){var t=e.match(this.WHITESPACE_REGEX);return t?t[1]:""}},{key:"getNextToken",value:function(e,t){return this.getCommentToken(e)||this.getStringToken(e)||this.getOpenParenToken(e)||this.getCloseParenToken(e)||this.getPlaceholderToken(e)||this.getNumberToken(e)||this.getReservedWordToken(e,t)||this.getWordToken(e)||this.getOperatorToken(e)}},{key:"getCommentToken",value:function(e){return this.getLineCommentToken(e)||this.getBlockCommentToken(e)}},{key:"getLineCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.LINE_COMMENT,regex:this.LINE_COMMENT_REGEX})}},{key:"getBlockCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.BLOCK_COMMENT,regex:this.BLOCK_COMMENT_REGEX})}},{key:"getStringToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.STRING,regex:this.STRING_REGEX})}},{key:"getOpenParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.OPEN_PAREN,regex:this.OPEN_PAREN_REGEX})}},{key:"getCloseParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.CLOSE_PAREN,regex:this.CLOSE_PAREN_REGEX})}},{key:"getPlaceholderToken",value:function(e){return this.getIdentNamedPlaceholderToken(e)||this.getStringNamedPlaceholderToken(e)||this.getIndexedPlaceholderToken(e)}},{key:"getIdentNamedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.IDENT_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getStringNamedPlaceholderToken",value:function(e){var t=this;return this.getPlaceholderTokenWithKey({input:e,regex:this.STRING_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return t.getEscapedPlaceholderKey({key:e.slice(2,-1),quoteChar:e.slice(-1)})}})}},{key:"getIndexedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.INDEXED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getPlaceholderTokenWithKey",value:function(e){var t=e.input,n=e.regex,r=e.parseKey,a=this.getTokenOnFirstMatch({input:t,regex:n,type:o.PLACEHOLDER});return a&&(a.key=r(a.value)),a}},{key:"getEscapedPlaceholderKey",value:function(e){var t=e.key,n=e.quoteChar;return t.replace(new RegExp(s("\\"+n),"gu"),n)}},{key:"getNumberToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.NUMBER,regex:this.NUMBER_REGEX})}},{key:"getOperatorToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.OPERATOR,regex:this.OPERATOR_REGEX})}},{key:"getReservedWordToken",value:function(e,t){if(!t||!t.value||"."!==t.value)return this.getTopLevelReservedToken(e)||this.getNewlineReservedToken(e)||this.getTopLevelReservedTokenNoIndent(e)||this.getPlainReservedToken(e)}},{key:"getTopLevelReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.RESERVED_TOP_LEVEL,regex:this.RESERVED_TOP_LEVEL_REGEX})}},{key:"getNewlineReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.RESERVED_NEWLINE,regex:this.RESERVED_NEWLINE_REGEX})}},{key:"getTopLevelReservedTokenNoIndent",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.RESERVED_TOP_LEVEL_NO_INDENT,regex:this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX})}},{key:"getPlainReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.RESERVED,regex:this.RESERVED_PLAIN_REGEX})}},{key:"getWordToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:o.WORD,regex:this.WORD_REGEX})}},{key:"getTokenOnFirstMatch",value:function(e){var t=e.input,n=e.type,r=e.regex,a=t.match(r);return a?{type:n,value:a[1]}:void 0}}])&&D(t.prototype,n),r&&D(t,r),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var a=U(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return F(this,n)}}function F(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=[].concat(j(r.map((function(e){return Array.isArray(e)?e[0]:e}))),j(a.map((function(e){return Array.isArray(e)?e[0]:e})))),V=["CASE","END","EXCEPT","{% end %}","FROM","ORDER BY","HAVING","GROUP BY","LIMIT","SELECT","WHERE","WITH","PREWHERE"],H=["UNION","UNION ALL"],X=["AND","{%","ELSE","OR","WHEN","JOIN","INNER JOIN","ANY LEFT JOIN","ANY RIGHT JOIN","ANY INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN"],J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(o,e);var t,n,r,a=W(o);function o(){return M(this,o),a.apply(this,arguments)}return t=o,(n=[{key:"tokenizer",value:function(){return new P({reservedWords:B,reservedTopLevelWords:V,reservedNewlineWords:X,reservedTopLevelWordsNoIndent:H,stringTypes:['""',"''","U&''",'U&""',"$$"],openParens:["(","["],closeParens:[")","]"],indexedPlaceholderTypes:["$"],namedPlaceholderTypes:[],lineCommentTypes:["--"],specialWordChars:["{%","%}","{{","}}"],operators:["!=","<<",">>","||/","|/","::","->>","->","~~*","~~","!~~*","!~~","~*","!~*","!~","!!","%"]})}}])&&q(t.prototype,n),r&&q(t,r),o}(T);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Y={tinybird:J},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)throw new Error("Invalid query argument. Extected string, instead got "+$(e));return new J(t).format(e)},K=Object.keys(Y)}])}));
//# sourceMappingURL=sql-formatter.min.js.map